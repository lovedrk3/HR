@*@model List<Model.CompensationProgramModel>*@
@using Model
@model CompensationTandardsModel
    @{
        Layout = null;
    }

    <!DOCTYPE html>

    <html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>Add</title>
        <link href="~/hr/css/table.css" rel="stylesheet" />
        <script src="~/Scripts/jquery-1.10.2.js"></script>
        <script src="~/Scripts/jquery.validate.js"></script>
        <script src="~/Scripts/jquery.validate.unobtrusive.js"></script>
        <script type="text/javascript">
        $(function()
        {
            var myDate = new Date;
            var year = myDate.getFullYear();//获取当前年
            var yue = myDate.getMonth() + 1;//获取当前月
            var date = myDate.getDate();//获取当前日
            var h = myDate.getHours();//获取当前小时数(0-23)
            var m = myDate.getMinutes();//获取当前分钟数(0-59)
            var s = myDate.getSeconds();//获取当前秒
            var Ctid = "13533" + year + m + s
            $("#Ctid").val(Ctid);
            $("#ctMoneyid").val("0.0");

            
               
                         
        })


        $(function () {
            //薪酬项目复选框（最开始时）
            var html = $("#projectSetting");
            $.ajax({
                url: "/CompensationTandards/Checked",
                type: "get",
                success: function (meg) {
                    dt = eval("(" + meg + ")");
                    var h = "";
                    html.html("");
                    $.each(dt, function (i, data) {
                        h += "<input   type='checkbox' name='' value='" + data.id + "'  />" + data.CpName;
                    })
                    html.append(h);
                }
            })



            //全选
            $("#AllChecked").click(function () {             
                $("#projectSetting").children().each(function () {
                    
                    if ($("#AllChecked").prop('checked')) {
                       
                        $(this).attr("checked", true);
                    } else {
                        $(this).attr("checked", false);
                    }
                });
            });

            //复选框显示隐藏
            $("#ok").click(function () {
               
                $("#show").show();
                $("#showProject").hide();
                var r = $("#projectSetting").children();
                var myhtm = "";
                var myhtm2 = "";
                var myhtm3 = "";
                var tcb = $("#show");
                tcb.html("");
                for (var i = 0; i < r.length; i++) {
                    if (r[i].checked) {
                        myhtm += " <tr class='TD_STYLE2'> <td align='center'>" + r[i].value + " </td> <td colspan='3'> " + r[i].nextSibling.nodeValue + "  </td> <td> <input type='text' id='salary" + r[i].value + "' value='0.00' name='details[0].salary'  onkeyup='countMoney(\"6\",\"salary" + r[i].value + "\")' class='INPUT_STYLE2 dd'> <input type='hidden' name='details[0].itemId' value='" + r[i].value + "'/> <input type='hidden' name='details[0].itemName' value='" + r[i].nextSibling.nodeValue + "'/></td> <td colspan='3'>  &nbsp; </td> </tr>"
                     
                       
                    }

                }
                tcb.append(myhtm);
            })

            //总金额叠加
            function countMoney(obj, o) {

                if (isNaN(document.getElementById(o).value) || document.getElementById(o).value < 0) {
                    alert("金额填写错误!");
                    document.getElementById(o).value = "0.00";
                    return;
                }
                var sum = 0;
                for (var i = 1; i <= obj; i++) {
                    var salary = document.getElementById("salary" + i).value;
                    if (salary == "") {
                        salary = "0.00";
                    }
                    sum = Number(sum) + Number(salary);

                }
                document.getElementById("sumSalary").value = sum;

            }



        })
        </script>
    </head>
    <body>
        <div id="div1">
            @using (Html.BeginForm("Add", "CompensationTandards", FormMethod.Post, new {id = "xingchou" }))
            {
                <table width="100%">
                    <tr>
                        <td>
                            <font color="black">
                                您正在做的业务是：人力资源--薪酬标准管理--薪酬标准登记
                            </font>
                        </td>
                    </tr>
                    <tr>
                        <td align="right">
                            <input type="submit" value="提 交" class="BUTTON_STYLE1">
                            <input type="reset" value="返 回" class="BUTTON_STYLE1">
                        </td>
                    </tr>
                </table>
                <table id="stable" width="100%" border="1" cellpadding=0 cellspacing=1
                       bordercolorlight=#848284 bordercolordark=#eeeeee
                       class="TABLE_STYLE1">
                    <tr>
                        <td width="74" class="TD_STYLE1">
                            薪酬标准编号
                        </td>
                        <td width="168" class="TD_STYLE2">
                            @Html.TextBox("Ctid", null, new { @class = "INPUT_STYLE2", @name = "standard.standardId", @id = "Ctid", @readonly = "readonly" })
                        </td>
                        <td width="83" class="TD_STYLE1">
                            薪酬标准名称
                        </td>
                        <td width="171" class="TD_STYLE2">
                            @Html.TextBox("CtName", null, new { @class = "INPUT_STYLE2" })
                            @Html.ValidationMessage("CtName", new { @class = "color" })
                        </td>
                        <td width="170" class="TD_STYLE1">
                            薪酬总额
                        </td>
                        <td width="138" class="TD_STYLE2">
                            @Html.TextBox("CtMoney", null, new { @class = "INPUT_STYLE2", @readonly = "readonly", @id = "ctMoneyid" })
                        </td>
                        <td width="103" class="TD_STYLE1">
                            &nbsp;
                        </td>
                        <td width="95" height="26" class="TD_STYLE2">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td class="TD_STYLE1">
                            制定人
                        </td>
                        <td class="TD_STYLE2">
                            @Html.TextBox("CtMan", null, new { @class = "INPUT_STYLE2" })
                            @Html.ValidationMessage("CtMan", new { @class = "color" })
                        </td>
                        <td class="TD_STYLE1">
                            登记人
                        </td>
                        <td class="TD_STYLE2">
                            @Html.TextBox("Ctregist", Session["uName"], new { @class = "INPUT_STYLE2" })
                            @Html.ValidationMessage("Ctregist", new { @class = "color" })
                        </td>
                        <td class="TD_STYLE1">
                            登记时间
                        </td>
                        <td class="TD_STYLE2">
                            @Html.TextBox("CtregistDate", null, new { @class = "INPUT_STYLE2", @name = "standard.registTime", @id = "Tdate", @readonly = "readonly" })
                        </td>
                        <td class="TD_STYLE1">
                            &nbsp;
                        </td>
                        <td class="TD_STYLE2">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td class="TD_STYLE1">
                            备注
                        </td>
                        <td colspan="7" class="TD_STYLE2">
                            <textarea name="standard.remark" rows="4" class="TEXTAREA_STYLE1"></textarea>
                        </td>
                    </tr>
                    <tr class="TD_STYLE1">
                        <td align="center">
                            序号
                        </td>
                        <td colspan="3">
                            薪酬项目名称
                        </td>
                        <td>
                            金额
                        </td>
                        <td colspan="3">
                            &nbsp;
                        </td>
                    </tr>
                    <tbody id="showProject">



                        <tr>
                            <td colspan="8">
                                <div style="position:relative; left:500px;">

                                    全选<input type="checkbox" id="AllChecked" />
                                    <div id="projectSetting" style="width:330px; border:1px solid grey;">

                                    </div>

                                    <br />
                                    <input id="ok" type="button" value="确认" />
                                    <br />
                                    <br />
                                </div>
                            </td>
                        </tr>
                    </tbody>

                    <tbody id="show"></tbody>
                </table>
                <p>
                    &nbsp;
                </p>
            }
        </div>
        @*<script type="text/javascript">
           
            var vm = new Vue({
                
            el: "#div1",
            data: {
                danhao:""
            },
            methods: {
                ids: function () {
                    var t = this;
                  
                },
                //adds: function () {
                    
                //    var t = this;
                //    //定义详情集合
                //    var arry = new Array();
                //    var i=0;
                //    $("#show tr").each(function (index, odd) {
                //        //获单个取详情对象（一行一个对象）
                //        var detail = {
                //            id: $(odd).children().eq(0).text(),
                //            names: $(odd).children().eq(1).text(),
                //            money:$(odd).children().eq(2).children().eq(0).val()
                //        }
                //        arry[i] = detail;
                //        alert(arry[i]);
                //        i++;
                //    })
                   
                //        $.ajax({
                //            url: "/CompensationTandards/Add",
                //            type: "post",
                //            data: $("#xingchou").serialize() + "&&arry=" + JSON.stringify(arry),
                //            success: function (flag) {
                //                alert(flag);
                //                if (flag == "true") {
                //                    alert("添加成功！");

                //                    window.location.href = "/salary_standard/Index";
                //                } else {
                //                    alert("添加失败!");
                //                }
                //            }
                //        })
                    


                //}
            },
            created: function () {

            }
        })
        </script>*@

        <script type="text/javascript">
            function check() {

                var designer = document.getElementById("designer");
                var standardName = document.getElementById("standardName");
                if (designer.value.length <= 0) {
                    alert("制定人不可为空!!!");
                    return;
                }
                if (standardName.value.length <= 0) {
                    alert("薪酬标准名称不可为空!!!");
                    return;
                }
                document.forms[0].submit();
            }
            function countMoney(obj, o) {

                if (isNaN(document.getElementById(o).value) || document.getElementById(o).value < 0) {
                    alert("金额填写错误!");
                    document.getElementById(o).value = "0.00";
                    return;
                }
                var sum = 0;
                for (var i = 1; i <= obj; i++) {
                    var salary = document.getElementById("salary" + i).value;
                    if (salary == "") {
                        salary = "0.00";
                    }
                    sum = Number(sum) + Number(salary);

                }
                document.getElementById("sumSalary").value = sum;

            }
            function time() {
                var tdate = document.getElementById("Tdate");
                var d = new Date();
                var y = d.getFullYear();
                var moth = d.getMonth() + 1;
                var date = d.getDate();
                var h = d.getHours();
                var m = d.getMinutes();
                var s = d.getSeconds();
                var hh = 20 - 1 - h;
                var mm = 60 - 1 - m;
                var ss = 60 - s;
                if (hh > 0) {
                    mm = mm + 60 * hh;
                }
                if (moth < 10) {
                    moth = "0" + moth;
                }
                if (date < 10) {
                    date = "0" + date;
                }
                if (h < 10) {
                    h = "0" + h;
                }
                if (m < 10) {
                    m = "0" + m;
                }
                if (s < 10) {
                    s = "0" + s;
                }
                if (mm < 10) {
                    mm = "0" + mm;
                }
                if (ss < 10) {
                    ss = "0" + ss;
                }

                tdate.value = y + "-" + moth + "-" + date + " " + h + ":" + m + ":" + s;

            }
            window.onload = time;
            var out = window.setInterval(time, 1000);






           
        
      
        </script>



    </body>
</html>
